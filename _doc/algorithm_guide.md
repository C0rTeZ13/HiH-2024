# Алгоритм обнаружения и рассчета площадей деталей

## Содержание

- [Алгоритм обнаружения и рассчета площадей деталей](#алгоритм-обнаружения-и-рассчета-площадей-деталей)
  - [Содержание](#содержание)
  - [Описание процесса](#описание-процесса)
  - [Обучение модели](#обучение-модели)

## Описание процесса

Опишем последовательнось для изображения, попавшего на сервер для обработки:
1. Изображение вместе с указаным эталоном передаётся python-скрипту с обученной моделью.
2. Нейросеть возвращает обнаруженные детали машины и их контуры (битовые маски над двумерным массивом изображения).
3. По маскам считается площадь покрытия контура (количество пикселей)
4. Полученные значения в сравнении с известной фактической площадью эталона дают искомые площади деталей.
5. Скрипт возвращает серверу изображение с выделением найденных частей и .csv файл с их площадями.

## Обучение модели

> [!IMPORTANT]
> Из-за веса обученной нейросети она не загруженна в git-репозиторий и доступна по ссылке на диск: [Яндекс.Диск](https://disk.yandex.ru/d/WxdX_FwFQdTang) (файл - best.pt)

В качестве базовой модели была выбрана YOLOv8 за её хорошие начальные показатели для решения задачи обнаружения объектов.

Для обучения использовался размеченный нами датасет.  80 самолично размеченных изображений было аугментированно до 192.

> [!TIP]
> Фотографии были отобраны только под прямым углом видимости, из-за чего полученная модель будет неверно реагировать на угловые фото.
> Для улучшения точности и вариативности можно обучать модель с ипользованием более точной разметки, при большем и различном датасете.

![](/_image/Dataset-info.jpg)

Обучение проводилось в течение 50 эпох.

Итоговые метрики модели:

![](/_image/results.png)

Примеры обнаружения частей автомобиля:

![](/_image/val_batch0_pred.jpg)
